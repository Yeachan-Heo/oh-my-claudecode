---
description: Scan codebase for malware, viruses, spyware, trojans, backdoors, and malicious code
---

# Malware Scan

[MALWARE SCAN MODE ACTIVATED]

## Objective

Conduct a comprehensive malware analysis of the codebase, detecting trojans, backdoors, spyware, cryptominers, ransomware, and other malicious code patterns.

## What Gets Scanned

### Critical Threats
- **Trojans & Backdoors** - Remote access, reverse shells, hidden functionality
- **Spyware** - Keyloggers, screen capture, credential theft
- **Ransomware** - File encryption, ransom demands
- **Cryptominers** - Unauthorized cryptocurrency mining
- **Data Exfiltration** - Stealing and transmitting sensitive data

### Supply Chain Risks
- **Typosquatting** - Malicious packages with similar names
- **Dependency Hijacking** - Compromised package updates
- **Postinstall Scripts** - Malicious installation hooks

### Code Analysis
- **Obfuscation** - Hidden malicious intent
- **Encoded Payloads** - Base64/hex encoded malware
- **Dynamic Execution** - Eval injection, code loading
- **Privilege Escalation** - Attempts to gain elevated access

## When to Use

- Before cloning/using external repositories
- After installing new dependencies
- During security incident investigation
- Before production deployments
- Regular security audits
- After suspicious behavior is observed

## Invocation

This command delegates to the `malware-detector` agent (Opus model) for deep threat analysis.

The agent will:
1. Scan for backdoors and reverse shell patterns
2. Detect data exfiltration and spyware code
3. Identify cryptominer signatures
4. Check for obfuscated malicious code
5. Analyze supply chain risks (dependencies)
6. Search for ransomware patterns
7. Run `npm audit` for known vulnerabilities
8. Generate a comprehensive threat report with risk scoring

## Output

A malware scan report with:
- Overall risk score (0-100)
- Threat classification (CLEAN/SUSPICIOUS/INFECTED)
- Critical threats requiring immediate action
- File locations and evidence
- Supply chain analysis
- Behavioral indicators
- Remediation recommendations

## Quick Scan Option

For faster scans on small changes, use the `malware-detector-low` agent (Haiku model) which focuses on the most critical threat patterns.
