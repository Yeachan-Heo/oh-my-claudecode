/**
 * Types for Malware Detection Feature
 */

export type ThreatSeverity = 'CRITICAL' | 'HIGH' | 'MEDIUM' | 'LOW' | 'INFO';

export type ThreatCategory =
  | 'TROJAN'
  | 'BACKDOOR'
  | 'SPYWARE'
  | 'KEYLOGGER'
  | 'CRYPTOMINER'
  | 'RANSOMWARE'
  | 'DATA_EXFILTRATION'
  | 'SUPPLY_CHAIN'
  | 'OBFUSCATION'
  | 'PRIVILEGE_ESCALATION'
  | 'PERSISTENCE'
  | 'INJECTION';

export interface ThreatPattern {
  id: string;
  name: string;
  category: ThreatCategory;
  severity: ThreatSeverity;
  description: string;
  pattern: RegExp;
  fileTypes: string[];
  falsePositiveHint?: string;
}

export interface ThreatMatch {
  pattern: ThreatPattern;
  file: string;
  line: number;
  content: string;
  context: string;
}

export interface ScanResult {
  scannedAt: Date;
  targetPath: string;
  filesScanned: number;
  riskScore: number;
  verdict: 'CLEAN' | 'SUSPICIOUS' | 'INFECTED';
  threats: ThreatMatch[];
  summary: {
    critical: number;
    high: number;
    medium: number;
    low: number;
  };
}

export interface SupplyChainRisk {
  package: string;
  version: string;
  risk: ThreatSeverity;
  reason: string;
  recommendation: string;
}
